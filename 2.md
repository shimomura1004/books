# 2. ランク・逆行列・一次方程式　結果から原因を求める
## 2.1 問題設定：逆問題
- y=Ax の形で表すことができる問題は多い
- x(原因)が既知で y(結果)を求める問題を順問題、y が既知で x を求める問題を逆問題という

## 2.2 たちがいい場合(正則行列)
- 逆問題を解くには A の逆行列を求めて A^(-1) y を計算すればいいが、面倒
  - 逆行列が存在しない(どこかの次元が潰れる)場合もある(その場合は解が一意に決まらなくなる)
- 逆行列が存在する正方行列のことを正則行列といい、正則でない行列は特異行列という
- 逆問題とは、すなわち連立方程式のこと
  - 普通に変数を削除して解けばいい
  - その手順を行列として見ると、ブロック行列 (A | y) を (I | s) に変換したときの s が解となる
- 連立方程式を解くときにする操作(基本変形: 行の定数倍、行の入れ替え、ある行の定数倍を他の行に足す)は行列の積で表現できる
- n 次正方行列 A の逆行列 X を求めるとは、つまり AX = I となるような X を求めること
  - 列ごとに見ると、 AX_i = I_i となる X_i を各 i (i=0からn-1) について求めればいい
  - ひとつひとつの X_i は、上で見たように基本変形を繰り返して (A | y) を (I | s) にする処理をすれば求まる
  - しかもどの X_i も同じ基本操作で求めることができるので、全部まとめて (A | I) を (I | X) に変形することを考えれば、X のところに A の逆行列が現れる

## 2.3 たちが悪い場合
- 「たちが悪い」 = 「求めたい情報に対して手がかりが足りない」もしくは「手がかりが多すぎて矛盾する」
- Y = AX で Y から X を求める場合、もし Y の列の数が X の列の数よりも少ないと、「手がかりが足りない」ということになる
  - つまり行列 A によって X を写像する際に、ひとつ以上の軸が潰れてしまっていて、情報が削られてしまっている
- 核(kernel): 与えられた A に対し、AX = o になるような X の集合(= Ker A) つまり元の空間の領域
- 像(image): 与えられた A に対し、X をいろいろ変えた場合に Y = AX が取る値の集合(= Im A) つまり行き先の空間の領域
  - もし(実際の計測で得られた) Y が(ノイズの影響で) Im A に含まれていなかった場合は、対応する X が求められず問題となる
- 全射: 写り先の全ての領域 Y に対し、Y=AX となる X が存在するとき、A は全射
  - Im A(行列 A によって写される領域)が、行き先の全領域に一致するとき、全射
- 単射: 写り先の領域の点 Y に対し、Y=AX となる X がただひとつであるとき、A は単射
  - Ker A(行列 A によって原点 O に写る値の集合)が原点 O のみであるとき、単射
- 次元定理: m x n 行列 A について dim Ker A + dim Im A = n
  - dim Ker A は dim (Ker A) なので、行列 A によって原点 O に潰れる値の集まり
    - dim (Ker A) = 2 なら、2次元の領域(面)が原点 O に潰れる
  - dim Im A は dim (Im A) なので、行列 A によって写される値の集まり
    - dim (Im A) = 2 なら、X を色々動かして AX を求めると2次元空間に散らばる
  - つまり次元定理は、n - dim Ker A = dim Im A とすると
    - m x n 行列(n 次元を m 次元に写す行列)は、n 次元の行列が「Ker A 次元分潰れると」残った次元が Im A である(つまり A による行き先の次元(=m)である)
  - m < n のとき、次元が潰れるので、必ずどこかの複数の点が同一の点に潰れる(単射ではない)
  - m > n のとき、次元が増えるので、全領域をカバーすることができない(全射ではない)
- 次元定理の証明
  - m x n 行列 A の dim Ker A = k, dim Im A = r のとき、k + r = n を証明すればいい
  - Ker A や Im A が線形空間であることを利用して証明 p122
- 行列 A の列ベクトル a1, a2 ... が
  - 線形独立: A によって写像した行列がつぶれない
  - 線形従属: A によって写像した行列がつぶれる
    - ある列ベクトルが他の列ベクトルの和で表現できる状態。a1 が a2 と a3 で表すことができるとき、a1 は a2 と a3 で張られる平面に乗っかっている。つまり a1 成分がどれだけ動いてもこの平面から抜け出すことができない(潰れている)
- 基底と線形独立について、あるベクトルの組が線形独立であっても、それがある空間の基底となるかは不明
  - 空間内のすべての点をベクトルの線形和で表せないといけないので、線形独立なベクトルを限界まで集めないといけない
- dim Im A を A のランクといい、rank A と書く
  - Y=AX に対して、X を色々動かしたときに Y が動く空間が Im A
  - 次元定理があるので Ker A と rank A はほぼ等価。つまり rank がわかれば A が正則かどうかわかる。

p130
