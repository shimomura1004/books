# 3. ベイズの識別規則
## 3.1 ベイズの識別規則
- ベイズの識別規則では、事後確率が最も大きくなるクラスに分類する
  - 事後確率: あるデータ x が観測されたとき、それが最も起こりやすいように確立を推定する
    - `P(Ci | X) = P(X | Ci) / P(X) * P(Ci)`
    - `P(Ci | X)`: 事後確率。あるデータ X が得られたと知ったときに、それが Ci に属する確率。
    - `P(X | Ci)`: クラス条件付き確率(尤度)。クラス Ci に属するデータとして X が得られる確率。逆に見ると、「データ X がクラス Ci に属する尤もらしさ」と見ることができるので、尤度という。
    - `P(X)` : 周辺確率。データが X となる確率。
    - `P(Ci)`: 事前確率。(今後得られる)データに関係なく、(今の時点で)あるデータがクラス Ci に属する確率。
    - データ X が得られたとき、クラスを指定して得られた生起確率(尤度) `P(X | Ci)` と、特にクラスを指定せずに求まる生起確率 `P(X)` を比較し、前者のほうが大きければ(`P(X | Ci) / P(X) > 1` なら)事後確率は大きくなる。逆なら小さくなる。
- 誤り率: 何らかの方法でクラスを予測した場合に、間違える確率
  - ベイズ識別規則を使った場合、誤り率が最小になるように識別境界が設定される(それがいいこととは限らない)
  - C1 と C2 の2クラスへの分類を考える。C1/C2 に判別される領域を R1/R2 とすると、C1 のクラスの値を間違って C2 だと判定してしまう確率は、R2 に入ってしまっている C1 の値の割合である。同様に C2 のクラスの値を間違って C1 だと判定してしまう確率は、 R1 に入ってしまっている C2 の値の割合である。
  - ベイズ識別境界は、上記2つの誤り率の和が最小になるところに設定される(p26 の図を参照)
  - 健康でない人を健康と判断してしまうことのリスクは、その逆よりも大きい。それぞれのパターンに対する誤り率に対して重みづけを行うと、このような要求を表現できる。
  - 誤り率が大きい点(識別境界の近く)の値はクラス判定せずリジェクトすることで、誤り率を下げることができる

## 3.2 受信者動作特性曲線
- ベイズ識別規則は誤り率が最小になるが、それでもクラスに重なりがある場合は必ず誤りが生じる
- 簡便な性能評価の指標として受信動作特性曲線(ROC曲線)がある
- 適合率と再現率はトレードオフの関係にある
  - 適合率: 検索された文書の中の適合文書の割合
  - 再現率: 適合している全文書のうち検索できたものの割合
  - 検索の基準をゆるくすれば多くの文書が検索されて再現率が上がるが、ノイズも増えるので適合率は下がる
- ROC 曲線は、偽陽性率と真陽性率の関係である
  - 偽陽性率: 陰性のものを間違って陽性と判断した率
  - 真陽性率: 陽性のものを正しく陽性と判断した率
  - つまり ROC 曲線は陽性と判断されたもののみで作る指標なので、陽性のサンプル数と陰性のサンプル数に大きな違いがあっても関係ない
    - 特に病気などは陽性のサンプル数が少ないので昔から使われてきた
  - p32 の図を参照。陽性クラスの尤度、陰性クラスの尤度をそれぞれグラフにし、識別境界をふたつのクラスの端から端まで動かしながら、偽陽性率と真陽性率の関係をプロットする
    - たとえば識別境界をずらして全て陽性と判定するようにすると、真陽性率は100%になる(全ての陽性サンプルは正しく陽性となる)が、偽陽性も100%になる(全ての陰性サンプルは全て陽性と判断される)
    - 同じく全て陰性と判断するようにすると、真陽性率も偽陽性率も0%になる
  - ROC 曲線の右下の領域の面積が大きいほど性能が高い
    - クラスが完全に分離しているときは完全な識別境界を定めることができて、そこでは偽陽性率が0%、真陽性率が100%となるので、(0,0)->(0,1)->(1,0)という線が引かれる(面積は最高の1)

p33