# 4. 確率モデルと識別関数
- データを元にクラスを判別する場合、使う複数の指標の間には相関がないほうがいい
  - 相関があるなら、どちらか一方のデータを使えばいいので、単に冗長な情報である

## 4.1 観測データの線形変換
- データの分布を表す統計量として、平均ベクトルと共分散行列がよく使われる
- 平均ベクトル: d 次元のデータがたくさんあるとき、その列ごとに平均を取ったもの
- 共分散行列: データから平均ベクトルを引いたものと、その転置ベクトルの積(データが d 次元なら d x d 行列となる)
  - 対角成分は分散、それ以外は共分散になる
- データの各列で分布が異なるとうまく比較ができない
  - データを平均 0、分散 1 に変換することを標準化という
  - データの平均が mu、データの分散が sigma のとき、z = (x - mu) / sigma とした z を考えると、平均が 0 で分散が 1 になる
- データの無相関化
  - 無相関であっても独立であるとは限らないので注意すること
  - 最初に確認したとおり、データの各列に相関があると、データとしての価値が減る
    - データをうまく変換して相関をなくしたい
  - データ1つにつき2つの指標 x1,x2 が得られるとき、もし x1 と x2 に相関があると、データは x1,x2 座標上で斜めに分布する
    - この場合、x1 もしくは x2 の一方だけで十分
    - 斜めに軸を引いてやると、x1 と x2 をうまく使って、最もきれいに分布が見える軸が設定できる(次元が1つ減った)
    - この軸上にデータを射影すると、データがうまく散らばるようになる
  - 詳しくは主成分分析の章で
    - 固有ベクトルを求めて並べて行列 S を作る
    - 共分散行列を S で対角化できる
    - 各固有値は、対応する固有ベクトル方向の分散となる
    - S の各列は(基底ベクトルなので)直交している → 無相関化が完了
- データの白色化
  - 無相関化を行っても固有値に相当する分だけ特徴量の標準偏差に違いが残るので、これを標準偏差を全て1にする処理
  - 白色化では、無相関化と同様に、列間の相関をなくす
  - それに加えて各列の標準偏差が1になる(どれかひとつの列が大幅に大きな値を取る、みたいなことがない)
  - 白色化後のデータの共分散行列は単位行列となる

## 4.2 確率モデル
- データの分布を、「なんらかの確率モデルに当てはめて、そのパラメータを推定することで表す」ものをパラメトリックモデル
- 同じく「特定の確率モデルを仮定しない」ものをノンパラメトリックモデル
- データの分布として正規分布を仮定することが多い
  - 正規分布に従うデータは多い
  - データが直接に正規分布に従わなくても、データの平均(標本平均)の分布は正規分布になる(中心極限定理)
- i 番目のクラスのクラス条件付き確率 P(x|Ci) が正規分布に従うときの、ベイズの誤り率最小識別規則を満たす識別関数を求める
  - クラス条件付き確率: クラス Ci の中の x の分布が P(x|Ci)
  - 事後確率 P(Ci|x) はいつもどおり、 P(Ci | x) = P(x | Ci) * P(Ci) / P(x) である
  - 各クラス Ci について事後確率を計算し、等しくなるところが境界となる
    - 識別境界は一般的に2次曲面となる
    - 2つのクラスの共分散行列が等しい場合は線形識別関数になる
  - P(x) は全てのクラスについて共通なので、大小を比較する(所属するクラスを求める)場合には無視していい
  - データの次元が増えても基本的な考え方は同じ

## 4.3 確率モデルパラメータの最尤推定
- f(x|θ): 真の分布のパラメータが θ のときに、データ x が出てくる確率
- f(x|θ) から N 個のデータを取り出したら、その確率は積となる
- 逆に、N 個のデータが得られているときに、パラメータ θ を推定することを考える
  - θ の関数であることを強調するために L(θ) = f(x1, x2... | θ) と書くことにする(f は尤度、L は尤度関数)
- 尤度を最大にする θ が見つけて、それを求めるパラメータとすることは妥当である(最尤推定)
  - データ x1...xN が発生する確率が最も大きくなるような θ をパラメータと推定する
  - L(θ) もしくは対数を取った ln L(θ) をパラメータ θ で微分して、傾きが 0 になるところ(山のてっぺん)を探す
- p52 の正規分布の例。真のモデルが正規分布に従う場合、推定すべきパラメータは平均と分散である
  - L(μ, σ^2) = ...

p52